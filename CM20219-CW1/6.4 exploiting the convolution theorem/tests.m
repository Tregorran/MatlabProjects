kernel = ones(5) / 25;
%kernel = [-1, 0 ,1];
image = im2double(imread('cameraman.tif'));
filtered = convolution_theorem(image, kernel);
reference = imfilter(image, kernel, 'replicate', 'conv');
difference = 0.5 + 10 * (filtered - reference);
ssd = sum((filtered(:) - reference(:)) .^ 2);
subplot(131); imshow(filtered); title('convolution theorem');
subplot(132); imshow(reference); title('Reference result');
subplot(133); imshow(difference); title(sprintf('Difference (SSD=%.1f)',ssd));
